namespace: code-server
namePrefix: code-server-

components:
  - ../../components/namespace
  - ../../components/helm-app-template

resources:
  - image-automation.yaml

configMapGenerator:
  - name: values
    behavior: replace
    files:
      - values.yaml

secretGenerator:
  - name: code-server-env
    behavior: create
    files:
      - PASSWORD=config/password.encrypted

patches:
  - target:
      kind: HelmRelease
    patch: |
      - op: add
        path: /spec/values
        value:
          envFrom:
            - secretRef:
                name: code-server-env