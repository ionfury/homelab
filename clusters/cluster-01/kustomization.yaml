components:
  - ../../manifests/components/configurations/kustomization
resources:
  - image-update-automation.yaml
  - app-template-helm-repo.yaml

  - cert-manager
  - default
  - flux-system
  - kube-system
  - monitoring
  - network
  - policy
  - system
configMapGenerator:
  - name: cluster-vars
    namespace: flux-system
    envs:
      - cluster-vars.env
patches:
  - target:
      kind: Kustomization
    path: patch-kustomization.yaml
  - target:
      kind: Kustomization
    patch: |
      - op: replace
        path: /metadata/namespace
        value: flux-system
  - target:
      kind: GitRepository
    patch: |
      - op: replace
        path: /spec/secretRef/name
        value: flux-ssh-key
